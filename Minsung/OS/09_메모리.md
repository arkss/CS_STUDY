# 09. 메모리 추상화, 주소공간

## 01. 메모리 계층 구조

모두가 크고 빠르고 비휘발성이고 값싼 메모리를 원하지만 이는 불가능합니다.

따라서 등장한 개념이 **메모리 계층 구조** 입니다.

 메모리 계층 구조란 캐시메모리, 메인메모리, 디스크 스토리지 등의 서로 다른 특성을 갖는 메모리들을 층 구조로 구성하는 것을 말합니다.  



## 02. 주소공간이란

### 주소공간이란

프로세스가 물리 메모리를 직접 사용한다고 생각해봅시다.

프로그램이 물리 메모리의 모든 주소를 접근할 수 있다면 사용자는 실수나 고의로 다른 프로그램을 공격하고 시스템을 중지시킬 수 있습니다.

또한 CPU가 여러 프로그램을 번갈아 수행 시키는 것이 어려워집니다.

이러한 이유로 메모리 추상화, **주소공간** 이 도입되었습니다.

주소공간이란 프로세스가 메모리에 접근할 때 사용하는 주소들의 집합으로 각 프로세스는 자신마의 주소 공간을 갖습니다.

각 프로세스들의 주소 공간은 다른 프로세스들의 주소 공간과 독립되어 있습니다.



### Base와 Limit 레지스터

어떻게 각 프로세스들에게 서로 다른 주소 공간을 제공할지에 대해 생각해봅시다.

CPU에 `base`와 `limit` 라는 특별한 하드웨어 레지스터를 사용합니다.

base에는 프로그램이 적재된 메모리 시작 위치가, limit에는 프로그램의 크기가 저장이 됩니다.



프로세스가 명령어 반입이나 데이터를 읽고 쓰기 위해 메모리를 참조하면 프로세스가 참조하려는 메모리 주소에 base 레지스터 값을 더해줍니다.

또한 limit를 넘어간다면 다른 프로세스의 메모리를 건들지 못하도록 이를 막습니다.



base와 limit 레지스터를 사용하는 방법으로 위와 같이 **동적 재배치** 를 구현할 수 있지만 모든 메모리 참조마다 덧셈과 비교연산이 요구되는 단점이 있습니다.

> 이 방법은 초기 컴퓨터에서는 많이 사용되었으나 최근에는 CPU가 제공하는 보다 복잡하고 효율적인 방법들로 인해 거의 사용되고 있지 않습니다.          





## 03. 스와핑

**스와핑** 은 한 프로세스의 모든 이미지가 메모리로 적재되어 실행되다가 더 이상 실행되지 않을 때 다시 디스크로 내려 보내는 방법입니다.

스와핑의 결과로, 메모리에 여러 개의 분리된 빈 공간들이 만들어지며 프로세스들의 위치를 이동하여 빈 공간들을 하나의 큰 공간으로 합칠 수 있습니다.

이를 **메모리 조각 모음** 이라고 합니다. 메모리 조각 모음은 시간이 많이 걸리는 작업이기 때문에 자주 실행되지는 않습니다.



운영체제는 프로세스의 크기에 맞춰 메모리를 할당하게 되는데, 프로세스는 메모리가 동적으로 변하는 문제가 있습니다. 

따라서 프로세스의 크기가 실행 중에 증가할 것이라 예상되면 여분의 공간을 추가로 할당해 주는 것이 좋습니다.





## 레퍼런스

* 운영체제론

## 질문할 사항



## 추가 공부할 키워드

