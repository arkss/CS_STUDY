# [OS] 인터럽트

## 인터럽트란

인터럽트란 영어로 `방해하다, 중단시키다` 의 의미를 가지고 있으며 실제로 CPU가 프로그램을 실행하는 것을 중단하게 합니다.

왜, 언제, 무슨 이유로 CPU가 프로그램을 실행하는 것을 방해하는 것일까요?



CPU가 현재 A 프로그램을 실행중이라고 가정해봅시다.

그런데 A 라는 프로그램이 입출력 연산을 수행하게 되고, 입출력 연산은 CPU의 명령 수행속도에 비해 많이 느리기 때문에 CPU가 기다려야 합니다.

값비싼 CPU를 마냥 기다리게만 할 순 없으니 CPU는 그 시간에 B 프로그램을 실행하게 됩니다.

이 때 A 프로그램이 입출력이 끝났다면 CPU에게 이 사실을 알려야 합니다.

이를 인터럽트라고 합니다.



정리하자면, CPU가 프로그램을 실행하고 있을 때 입출력 하드웨어 등의 장치에 예외상황이 발생하여 처리가 필요한 경우에 CPU에게 알려 처리할 수 있도록 하는 것을 말합니다.



## 인터럽트의 종류

### 외부 인터럽트

CPU 외부에서 발생한 것을 전기적 신호를 통해 CPU에게 알리는 인터럽트입니다.

* 정전 전원이상 인터럽트
* 기계고장 인터럽트
* 외부 인터럽트
* 입출력 인터럽트



### 내부 인터럽트

CPU 내부에서 발생하는 인터럽트입니다.

* 프로그램 검사 인터럽트 : Divide by Zero, Overflow 등등



### 소프트웨어 인터럽트 

사용자가 프로그램을 실행시키거나 Supervisor를 호출하는 인터럽트로 Trap이라고도 합니다.

* Supervisor call : OS를 호출하는 경우



## 인터럽트 동작순서

### 인터럽트 요청

프로세스가 입출력 명령 등과 같이 user mode에서 수행할 수 없는 명령을 읽으면 인터럽트 라인에 인터럽트를 세팅합니다.

CPU가 인터럽트 라인을 검사하고 인터럽트가 발생한 것을 감지합니다.



### 프로그램 실행 중단

현재 실행중인 Micro Operation 까지 수행 후 해당 프로그램의 실행을 중단입니다.



### 현재 실행중인 프로그램 상태 보관

인트럽트 벡터에서 인터럽트 핸들러의 주소를 읽어 인터럽트 핸들러를 실행합니다.

현재 실행중인 프로그램의 정보를 PCB에 저장하여 이후에 불러올 수 있게 합니다.



### 인터럽트 핸들러 실행

인터럽트의 원인을 파악하고 실질적인 작업을 수행합니다.

인터럽트 핸들러 수행 중 우선순위가 높은 인터럽트가 발생하면 재귀적으로 전체 과정을 다시 수행합니다.



### 상태 복구

해당 작업을 마치면 기존의 프로세스의 정보를 다시 복구합니다.



### 

* 인터럽트 핸들러 : 인터럽트 서비스 루틴이라고도 하며 실제 인터럽트를 처리하기 위해 커널이 실행하는 함수
* 인터럽트 벡터 : 인터럽트 발생 시 처리해야하는 인터럽트 핸들러의 주소를 인터럽트 별로 보관하고 있는 테이블





## 레퍼런스

https://hibee.tistory.com/264

https://velog.io/@adam2/%EC%9D%B8%ED%84%B0%EB%9F%BD%ED%8A%B8

## 질문할 사항

## 추가 공부할 키워드