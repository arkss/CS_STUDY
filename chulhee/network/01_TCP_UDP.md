# 01. TCP와 UDP



## 0. 들어가기전 

OSI 7계층 중 **전송 계층**에 해당하는 역할은 데이터를 목적지까지 전달하는 기능입니다. 

- 서로 다른 호스트에서 동작하는 어플리케이션 프로세스 간 논리적 통신을 제공
- 물리적 하부 구조에 상관 없이 메시지 전송하기 위해 논리적 통신을 사용한다



그 중 인터넷에서 트랜스 포트 계층은
2가지 구별되는 서비스를 어플리케이션 계층에 제공합니다.

- UDP
- TCP





## 1. TCP와 UDP



## 1.1 TCP



- TCP
  - 오류 검출
  - 흐름 제어
  - 혼잡 제어
  - 순서 번호
  - 확인 응답
  - 타이머
- UDP
  - 오류 검출



### TCP : 연결지향형 트랜스포트

>  인터넷 상에서 데이터를 메세지 형태로 보내기 위해 IP와 함께 사용하는 프로토콜

TCP는 세그먼트(편의상 패킷)라는 프로토콜 데이터 유닛으로 표현합니다.

![image-20210122200137696](/Users/chulheelee/Repository/CS_STUDY/chulhee/assets/01_tcp_segment.png)

TCP 세그먼트 헤더 구조입니다. 세부 구조는 넘어가겠습니다. 



#### 특징

- 신뢰성 보장
- 연결지향형
  - 데이터 보내기 전 handshake 통해 연결 설정을 시도
- 혼잡 및 흐름제어
- 전이중 데이터 전송



#### 신뢰성 보장

- ACK : 상대 호스트로부터 기대하는 다음 순서번호를 의미 (Acknowledgment number)

- 다양한 알고리즘 사용하여 ack를 주고받음

  - Go-Back-N 알고리즘

    - 송신 : n개의 패킷 전송

    - 수신 : 수신할 때 **누적된** ACK 만 전송

      - 전송 중 누락된 패킷이 있다면 ACK를 못 받게됨. 

      - 특정 패킷을 수신하지 못하여 타임아웃 된 경우 해당 패킷 보내는 순서로 돌아가(GO-BACK-N) 재전송 시작

        **-> 데이터의 수신 순서를 보장한다는 특징 또한 만족**

  - 선택적 반복 알고리즘

    - 수신자가 오류가 발생했는지 의심가는 패킷만 송신자가 재전송

  - 슬라이딩 윈도우

    - 크기가 N 인 윈도우에 대해 ACK 응답 받지 않은 연속적인 N 개의 패킷 버퍼링이 일어난다.



#### 연결 설정

- 3-way handshake
  - 클라이언트 : 서버에 SYN 세그먼트 송신
  - 서버 : SYN 받고, SYN, ACK 응답
  - 클라이언트 : SYN, ACK 받고, ACK 응답

- 4-way handshake (연결 해제)

  - 클라이언트 : FIN 플래그 전송
  - 서버 : ACK 전송, 자신의 통신 끝날 때까지 기다림
  - 클라이언트 : 

  

#### 흐름제어

- 수신하는 어플리케이션의 읽는 속도와 송신자의 전송 속도를 같게 만든다

#### 혼잡제어

- 혼잡 : 패킷이 전송되는 경로 상의 데이터가 폭주
- 이를 제어하기 위해 네트워크 혼잡에 따라 연결에 트래픽을 보내는 전송률을 각 송신자가 제한하도록 한다 (종단간 혼잡제어)





## 1.2 UDP

> User Datagram Protocol. 비연결형 서비스. 연결의 설정과 해제가 없다.

![image-20210122212123423](/Users/chulheelee/Repository/CS_STUDY/chulhee/assets/01_udp_segment.png)

TCP 세그먼트 구조에 비해 간단한 구조입니다.

#### 특징

- 비연결형
  - 송수신측 간에 연결을 위한 어떠한 작업도 수행되지 않음
  - UDP 세그먼트끼리 어떤 관계 없이 독립적으로 다뤄짐
- 순서 보장되지 않음
- 패킷 손실 발생 가능



TCP 에 비해서 단점이 많은듯 해보이지만 선호되는 이유는 다음과 같습니다.

- 연결 설정이 없어 지연이 없음
- 혼잡제어를 수행하지 않기에 빠른 전송이 가능
- 대신 정교한 제어는 application layer 에서 일어납니다.





## 1.3 TCP 와 UDP 비교



### 사용 분야

| TCP                                     | UDP                                           |
| --------------------------------------- | --------------------------------------------- |
| 전자메일(SMTP), 웹(http), 파일전송(FTP) | 멀티미디어 스트리밍, 원격 파일 서버(NFS), DNS |







## 레퍼런스

- 전공 자료 참고
- https://gmlwjd9405.github.io/2018/09/19/tcp-connection.html
- https://mangkyu.tistory.com/15







## 추가 공부 키워드

- 다중화, 역다중화

- 흐름,혼잡제어

  - 라우팅 경로

  

















